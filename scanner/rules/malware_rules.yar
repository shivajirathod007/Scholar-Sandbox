rule EICAR_Test_File
{
    meta:
        description = "Standard EICAR Anti-Virus Test File"
        author = "Scholar Sandbox"
        reference = "http://www.eicar.org/86-0-Intended-use.html"
    strings:
        $eicar = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"
    condition:
        $eicar
}

rule Suspicious_Shell_Script
{
    meta:
        description = "Detects potentially malicious shell script heuristics"
        author = "Scholar Sandbox"
    strings:
        $s1 = "curl " nocase
        $s2 = "wget " nocase
        $s3 = "chmod +x" 
        $s4 = "/dev/tcp/" 
        $s5 = "nc -e" 
        $s6 = "base64 -d"
    condition:
        filesize < 50KB and 2 of them
}

rule Suspicious_Python_Script
{
    meta:
        description = "Detects potentially malicious python behaviors like dynamic execution or reverse shells"
        author = "Scholar Sandbox"
    strings:
        $s1 = "import pty"
        $s2 = "pty.spawn"
        $s3 = "socket.socket"
        $s4 = "os.system"
        $s5 = "subprocess.Popen"
        $s6 = "base64.b64decode"
        $s7 = "eval("
        $s8 = "exec("
    condition:
        filesize < 100KB and 3 of them
}

rule Suspicious_PE_Executable
{
    meta:
        description = "Detects suspicious PE (Windows Executable) characteristics"
        author = "Scholar Sandbox"
    strings:
        $mz = "MZ"
        $s1 = "VirtualAlloc" ascii
        $s2 = "CreateRemoteThread" ascii
        $s3 = "WriteProcessMemory" ascii
    condition:
        $mz at 0 and 2 of ($s*)
}
